<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>aghq: Adaptive Gauss-Hermite Quadrature for Bayesian inference</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>
<link href="data:text/css,%0Aa%2Eanchor%2Dsection%20%7Bmargin%2Dleft%3A%2010px%3B%20visibility%3A%20hidden%3B%20color%3A%20inherit%3B%7D%0Aa%2Eanchor%2Dsection%3A%3Abefore%20%7Bcontent%3A%20%27%23%27%3B%7D%0A%2EhasAnchor%3Ahover%20a%2Eanchor%2Dsection%20%7Bvisibility%3A%20visible%3B%7D%0A" rel="stylesheet" />
<script src="data:application/javascript;base64,Ly8gQW5jaG9yIHNlY3Rpb25zIHYxLjAgd3JpdHRlbiBieSBBdHN1c2hpIFlhc3Vtb3RvIG9uIE9jdCAzcmQsIDIwMjAuCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsKICAvLyBEbyBub3RoaW5nIGlmIEFuY2hvckpTIGlzIHVzZWQKICBpZiAodHlwZW9mIHdpbmRvdy5hbmNob3JzID09PSAnb2JqZWN0JyAmJiBhbmNob3JzLmhhc093blByb3BlcnR5KCdoYXNBbmNob3JKU0xpbmsnKSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgaCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2gxLCBoMiwgaDMsIGg0LCBoNSwgaDYnKTsKCiAgLy8gRG8gbm90aGluZyBpZiBzZWN0aW9ucyBhcmUgYWxyZWFkeSBhbmNob3JlZAogIGlmIChBcnJheS5mcm9tKGgpLnNvbWUoeCA9PiB4LmNsYXNzTGlzdC5jb250YWlucygnaGFzQW5jaG9yJykpKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIC8vIFVzZSBzZWN0aW9uIGlkIHdoZW4gcGFuZG9jIHJ1bnMgd2l0aCAtLXNlY3Rpb24tZGl2cwogIGNvbnN0IHNlY3Rpb25faWQgPSBmdW5jdGlvbih4KSB7CiAgICByZXR1cm4gKCh4LmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbicpIHx8ICh4LnRhZ05hbWUgPT09ICdTRUNUSU9OJykpCiAgICAgICAgICAgID8geC5pZCA6ICcnKTsKICB9OwoKICAvLyBBZGQgYW5jaG9ycwogIGguZm9yRWFjaChmdW5jdGlvbih4KSB7CiAgICBjb25zdCBpZCA9IHguaWQgfHwgc2VjdGlvbl9pZCh4LnBhcmVudEVsZW1lbnQpOwogICAgaWYgKGlkID09PSAnJykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGxldCBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICBhbmNob3IuaHJlZiA9ICcjJyArIGlkOwogICAgYW5jaG9yLmNsYXNzTGlzdCA9IFsnYW5jaG9yLXNlY3Rpb24nXTsKICAgIHguY2xhc3NMaXN0LmFkZCgnaGFzQW5jaG9yJyk7CiAgICB4LmFwcGVuZENoaWxkKGFuY2hvcik7CiAgfSk7Cn0pOwo="></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">aghq: Adaptive Gauss-Hermite Quadrature for Bayesian inference</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aghq)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>This vignette describes the <code>aghq</code> package for Bayesian inference using Adaptive Gauss Hermite Quadrature as described by <span class="citation">Bilodeau, Stringer, and Tang (2020)</span>. It is taken almost verbatim from Section 2 (Basic Use) of <span class="citation">Stringer (2020)</span>. It shows how to use the basic functions of the package to implement a very simple example of Bayesian inference using adaptive quadrature. For six challenging and illuminating examples, consult <span class="citation">Stringer (2020)</span>.</p>
<div id="a-simple-example" class="section level1">
<h1>A simple example</h1>
<p>The following conjugate model is used by <span class="citation">Bilodeau, Stringer, and Tang (2020)</span>: <span class="math display">\[\begin{equation}\begin{aligned}
Y_i | \lambda &amp;\overset{ind}{\sim} \text{Poisson}(\lambda), i\in[n], \\
\lambda &amp;\sim \text{Exponential}(1), \lambda &gt; 0, \\
\implies \lambda | Y &amp;\sim \text{Gamma}\left(1 + \sum_{i=1}^{n}y_{i},n+1\right), \\
\pi(\lambda,Y) &amp;= \frac{\lambda^{\sum_{i=1}^{n}y_{i}}e^{-n\lambda}}{\prod_{i=1}^{n}y_{i}!}\times e^{-\lambda}, \\
\pi(Y) &amp;= \frac{\Gamma\left(1 + \sum_{i=1}^{n}y_{i}\right)}{(n+1)^{\left(1 + \sum_{i=1}^{n}y_{i}\right)}\prod_{i=1}^{n}y_{i}!}
\end{aligned}\end{equation}\]</span> We apply a transformation: <span class="math display">\[\begin{equation}\begin{aligned}
\eta &amp;= \log\lambda, \\
\implies \log\pi(\eta,Y) &amp;= \eta\sum_{i=1}^{n}y_{i} - (n+1)e^{\eta} - \sum_{i=1}^{n}\log(y_{i}!) + \eta, \\
\end{aligned}\end{equation}\]</span> which, because the jacobian <span class="math inline">\(|d\lambda/d\eta|\)</span> is included, does not change the value of <span class="math inline">\(\pi(Y)\)</span>.</p>
<p>To approximate <span class="math inline">\(\pi(Y)\)</span> and then make Bayesian inferences based on <span class="math inline">\(\pi(\lambda|Y)\)</span>, first install and load the  package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stable version:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;aghq&quot;)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Or devel version:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;awstringer1/aghq&quot;)</span></span></code></pre></div>
<p>We will simulate some data from the model:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84343124</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">10</span>,<span class="dv">5</span>) <span class="co"># True lambda = 5, n = 10</span></span></code></pre></div>
<p>The main function is the <code>aghq::aghq</code> function. The user supplies a list containing the log-posterior and its first two derivatives:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the log posterior, log(pi(eta,y)) here</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>logpietay <span class="ot">&lt;-</span> <span class="cf">function</span>(eta,y) {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y) <span class="sc">*</span> eta <span class="sc">-</span> (<span class="fu">length</span>(y) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">exp</span>(eta) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">lgamma</span>(y<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">+</span> eta</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The objective function has to take a single argument, eta, so pass</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># in the data:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>objfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">logpietay</span>(x,y)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple numerical derivatives suffice here:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>objfuncgrad <span class="ot">&lt;-</span> <span class="cf">function</span>(x) numDeriv<span class="sc">::</span><span class="fu">grad</span>(objfunc,x)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>objfunchess <span class="ot">&lt;-</span> <span class="cf">function</span>(x) numDeriv<span class="sc">::</span><span class="fu">hessian</span>(objfunc,x)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now create the list to pass to aghq()</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>funlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> objfunc,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">gr =</span> objfuncgrad,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">he =</span> objfunchess</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now perform the quadrature. The only other required input is the number of quadrature points, <span class="math inline">\(k\)</span>, and a starting value for the optimization:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AGHQ with k = 3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use eta = 0 as a starting value</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>thequadrature <span class="ot">&lt;-</span> aghq<span class="sc">::</span><span class="fu">aghq</span>(<span class="at">ff =</span> funlist,<span class="at">k =</span> <span class="dv">3</span>,<span class="at">startingvalue =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>The object <code>thequadrature</code> has class <code>aghq</code>, with <code>summary</code> and <code>plot</code> methods:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thequadrature)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AGHQ on a 1 dimensional posterior with  3 quadrature points</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The posterior mode is: 1.493925 </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The log of the normalizing constant/marginal likelihood is: -23.32123 </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The posterior Hessian at the mode is:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,]   49</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The covariance matrix used for the quadrature is...</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.02040816</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ...and its Cholesky is:</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.1428571</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Here are some moments and quantiles for theta:</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            mean   median     mode        sd     2.5%    97.5%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta1 1.483742 1.482532 1.493925 0.1424943 1.204135 1.762909</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(thequadrature)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The actual object is a list with elements (see  for notation):</p>
<ul>
<li><p><code>normalized_posterior</code>: the output of the <code>aghq::normalize_posterior</code> function, which is itself a list with elements:</p>
<ul>
<li><p><code>nodesandweights</code>: a dataframe containing the nodes and weights from the quadrature and the normalized and un-normalized log posterior at the nodes,</p></li>
<li><p><code>thegrid</code>: a <code>NIGrid</code> object from the <code>mvQuad</code> package, see <code>?mvQuad::createNIGrid</code>,</p></li>
<li><p><code>lognormconst</code>: the numeric value of the approximation of the log of the normalizing constant <span class="math inline">\(\pi(Y)\)</span>.</p></li>
</ul></li>
<li><p><code>marginals</code>: a list of the same length as <code>startingvalue</code> of which element <code>j</code> is the result of calling <code>aghq::marginal_posterior</code> with that <code>j</code>. This is a <code>tbl_df/tbl/data.frame</code> containing the normalized marginal posterior for the <span class="math inline">\(j^{th}\)</span> element of <span class="math inline">\(\eta\)</span>. In this one-dimensional example, this is exactly the same information that is present in <code>thequadrature$normalized_logpost$nodesandweights</code>.</p></li>
<li><p><code>optresults</code>: information and results from the optimization of <span class="math inline">\(\log\pi^{*}(\eta,Y)\)</span>. This is itself a list with elements:</p>
<ul>
<li><p><code>ff</code>: the function list passed to <code>aghq</code>,</p></li>
<li><p><code>mode</code>: the mode of the log-posterior,</p></li>
<li><p><code>hessian</code>: the negative Hessian of the log-posterior, at the mode, and</p></li>
<li><p><code>convergence</code>: the convergence code, specific to the optimizer used.</p></li>
</ul></li>
</ul>
<p>We can observe the structure of the object and compare the results to the truth for this simple example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The normalized posterior:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>thequadrature<span class="sc">$</span>normalized_posterior<span class="sc">$</span>nodesandweights</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     theta1   weights   logpost logpost_normalized</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1.246489 0.2674745 -23.67784         -0.3566038</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 1.493925 0.2387265 -22.29426          1.0269677</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 1.741361 0.2674745 -23.92603         -0.6047982</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The log normalization constant:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>thequadrature<span class="sc">$</span>normalized_posterior<span class="sc">$</span>lognormconst</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -23.3212</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to the truth: </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lgamma</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">sum</span>(y)) <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">sum</span>(y)) <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">length</span>(y) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">lgamma</span>(y<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -23.3195</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Quite accurate with only n = 10 and k = 3; this example is very simple.</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># The mode found by the optimization:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>thequadrature<span class="sc">$</span>optresults<span class="sc">$</span>mode</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.49393</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># The true mode:</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>((<span class="fu">sum</span>(y) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">length</span>(y) <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.49393</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Of course, in practical problems, the true mode and normalizing constant wont be known.</p>
<p>The  package provides further routines for computing moments, quantiles, and distributions/densities. These are especially useful when working with transformations and we are in the example, since interest here is in the original parameter <span class="math inline">\(\lambda = e^{\eta}\)</span>. The main functions are:</p>
<ul>
<li><p><code>compute_pdf_and_cdf</code>: compute the density and cumulative distribution function for a marginal posterior distribution of a variable and (optionally) a smooth monotone transformation of that variable,</p></li>
<li><p><code>compute_moment</code>: compute the posterior moment of any function,</p></li>
<li><p><code>compute_quantiles</code>: compute posterior quantiles for a marginal posterior distribution.</p></li>
</ul>
<p>We will consider several examples. To compute the approximate marginal posterior for <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\widetilde{\pi}(\lambda|Y)\)</span>, first compute the marginal posterior for <span class="math inline">\(\eta\)</span> and then transform: <span class="math display">\[\begin{equation}
\widetilde{\pi}(\lambda|Y) = \widetilde{\pi}(\eta|Y)|\frac{d\eta}{d\lambda}|
\end{equation}\]</span></p>
<p>The <code>aghq::compute_pdf_and_cdf</code> function has an option, <code>transformation</code>, which allows the user to specify a parameter transformation that they would like the marginal density of. The user specifies functions <code>fromtheta</code> and <code>totheta</code> which convert from and to the transformed scale (on which quadrature was done), and the function returns the marginal density on both scales, making use of a numerically differentiated jacobian. This is all done as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the pdf for eta</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pdfwithlambda <span class="ot">&lt;-</span> <span class="fu">compute_pdf_and_cdf</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  thequadrature<span class="sc">$</span>marginals[[<span class="dv">1</span>]],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">transformation =</span> <span class="fu">list</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">totheta =</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fromtheta =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot along with the true posterior</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>lambdapostplot <span class="ot">&lt;-</span> pdfwithlambda <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> transparam,<span class="at">y =</span> pdf_transparam)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">sum</span>(y),<span class="at">rate =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">length</span>(y)),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(lambda),<span class="at">y =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>lambdapostplot</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Approximate () and true (- - -) posterior for <span class="math inline">\(\lambda\)</span></p>
</div>
<p>We may compute the posterior mean of <span class="math inline">\(\lambda = e^{\eta}\)</span>, <span class="math inline">\(\EE(\lambda|Y)\)</span>, using the <code>compute_moment</code> function. This can also be used to confirm that the posterior is, in fact, properly normalized:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the posterior integrates to 1, by computing the &quot;moment&quot; of &quot;1&quot;:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_moment</span>(thequadrature<span class="sc">$</span>normalized_posterior,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">ff =</span> <span class="cf">function</span>(x) <span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior mean for eta:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_moment</span>(thequadrature<span class="sc">$</span>normalized_posterior,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">ff =</span> <span class="cf">function</span>(x) x)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.48374</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior mean for lambda = exp(eta)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_moment</span>(thequadrature<span class="sc">$</span>normalized_posterior,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">ff =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4.45441</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to the truth:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(y) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">length</span>(y) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 4.45455</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Quantiles are computed using the <code>compute_quantiles</code> function. For example, to get the first and third percentiles along with median and first and third quartiles:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the quantiles for eta:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>etaquants <span class="ot">&lt;-</span> <span class="fu">compute_quantiles</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  thequadrature<span class="sc">$</span>marginals[[<span class="dv">1</span>]],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">25</span>,.<span class="dv">50</span>,.<span class="dv">75</span>,.<span class="dv">99</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The quantiles for lambda = exp(eta) are obtained directly:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(etaquants)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1%  25%  50%  75%  99% </span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3.17 4.00 4.40 4.85 6.15</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># and compared with the truth:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">25</span>,.<span class="dv">50</span>,.<span class="dv">75</span>,.<span class="dv">99</span>),<span class="at">shape =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">sum</span>(y),<span class="at">rate =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">length</span>(y))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3.11 4.01 4.42 4.87 6.07</span></span></code></pre></div>
<p>The estimation of quantiles, especially extreme quantiles, is much more difficult than that of moments, and this is reflected in the small differences in accuracy observed between the two in this example.</p>
<p>For more details, see <span class="citation">Bilodeau, Stringer, and Tang (2020)</span> and <span class="citation">Stringer (2020)</span>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aghqus" class="csl-entry">
Bilodeau, Blair, Alex Stringer, and Yanbo Tang. 2020. <span>Higher Order Accurate Approximate Bayesian Inference Using Adaptive Quadrature.</span> <em>In Preparation</em>.
</div>
<div id="ref-aghqimp" class="csl-entry">
Stringer, Alex. 2020. <span>Implementing Adaptive Quadrature for Bayesian Inference: The Aghq Package.</span> <em>In Preparation</em>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
